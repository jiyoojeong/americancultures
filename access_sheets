import pandas as pd
import pygsheets


def access():
    # authorization
    gc = pygsheets.authorize(service_file="/Users/jiyoojeong/Desktop/americancultures/client_secret.json")

    file_name_1 = "AC Classes List"
    file_name_2 = "Senate Approved AC Instructors"

    # courses
    f1 = gc.open(file_name_1)
    wk = f1[0]
    data = wk.get_all_values()
    headers = data.pop(0)
    classes = pd.DataFrame(data, columns=headers)

    # senate
    f2 = gc.open(file_name_2)
    depts = {}  # list of data frames with instructors based on departments.
    i = 0
    for s in f2:
        wk = f2[i]
        i = i + 1
        d_rows = wk.get_all_records()
        # print(wk.title)
        depts[wk.title.strip()] = d_rows

    return classes, depts


def in_dict(string1):
    # checks if string 1 is similar to string 2
    keys = dept_dict_inv.keys()
    values = dept_dict_inv.values()
    if string1 in keys:
        print("in longer")
        return "L"
    elif string1 in values:
        print("in shorter")
        return "S"
    else:
        print("not in dictionary")
        return "NONE"


synonyms = {"LINGUIS"}
dept_dict = {"AFRICAM": "AFRICAN AMERICAN STUDIES",
             "AMERSTD": "AMERICAN STUDIES",
             'ARCH': "ARCHITECTURE",
             'ART': "ART PRACTICE",
             'ARTHIST': "ART HISTORY",
             'ANTHRO': "ANTHROPOLOGY",
             'ASAMST': "ASIAN AMERICAN STUDIES",
             'UGBA': "BUSINESS ADMINISTRATION (UGBA)",
             'CHICANO': "CHICANO STUDIES",
             'CYPLAN': "CITY AND REGIONAL PLANNING",
             'COLWRIT': "COLLEGE WRITING",
             'COMPLIT': "COMPARATIVE LITERATURE",
             'DEMOG': "DEMOGRAPHY",
             'TDPS': "",
             'DUTCH': "DUTCH STUDIES",
             'EPS': "EARTH AND PLANETARY SCIENCE",
             'EDUC': "EDUCATION",
             'ENGIN': "ENGINEERING",
             'ENGLISH': "ENGLISH",
             'ENVECON': "ENVIRONMENTAL ECONOMICS",
             'ESPM': "ENVIRONMENTAL SCIENCE, POLIC...",
             'ETHSTD': "ETHNIC STUDIES",
             'FILM': "FILM STUDIES",
             'FRENCH': "FRENCH",
             'GEOG': "GEOGRAPHY",
             'GWS': "GENDER & WOMEN'S STUDIES (fo...",
             'LGBT': "LGBT",
             'GPP': "GLOBAL PROVERTY AND PRACTICE",
             'HISTORY': "HISTORY",
             'HUMAN BIODYNAMICS': "HUMAN BIODYNAMICS",  # MAY NEED ADJUSTMENT
             'INFO': "INFORMATION (formerly INFORM...",
             'INTEGBI': "INTEGRATIVE BIOLOGY",
             'INTERDEPARTMENTAL STUDIES': "INTERDEPARTMENTAL STUDIES",  # MAY NEED ADJUSTMENT
             'UNDERGRADUATE INTERDISCIPLINATRY STUDIES': "INTERDISCIPLINARY STUDIES"
             }  # may not be needed.

dept_dict_inv = {v: k for k, v in dept_dict.items()}


def main():
    # get data from google sheets
    courses, departments = access()
    #  for every course in course list, get the department, cross check with the dictionary of departments

    dept_names_long = courses["Department_FULL"]
    dept_names_short = courses["Department"]

    # testing that we're getting full names of the departments
    print(dept_names_long[0])
    print(departments)

    # loop through each row, check that the instructors are on the senate list.
    print(len(courses))
    for c in range(0, len(dept_names_long)):
        d_i = dept_names_long[c]
        print(d_i)
        in_d = in_dict(d_i)
        if in_d == "L":
            s = departments[d_i]
            print(s)
        elif in_d == "S":
            key = dept_dict_inv[d_i]
            print(key)
            s = departments[key]
            print(s)
        else:
            print("check for errs")



main()

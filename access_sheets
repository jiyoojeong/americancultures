import pandas as pd
import pygsheets

def access():
    # authorization
    gc = pygsheets.authorize(service_file="/Users/jiyoojeong/Desktop/americancultures/client_secret.json")

    file_name_1 = "AC Classes List"
    file_name_2 = "Senate Approved AC Instructors"

    # courses
    f1 = gc.open(file_name_1)
    wk = f1[0]
    data = wk.get_all_values()
    headers = data.pop(0)
    classes = pd.DataFrame(data, columns=headers)

    # senate
    f2 = gc.open(file_name_2)
    depts = {}  # list of data frames with instructors based on departments.
    i = 0
    for s in f2:
        wk = f2[i]
        i = i + 1
        d_rows = wk.get_all_records()
        # print(wk.title)
        depts[wk.title.strip()] = d_rows

    return classes, depts


def close_ish(string1, string2):
    # checks if string 1 is similar to string 2
    if string1 in ["COLWRIT", ]


def main():
    # get data from google sheets
    courses, departments = access()

    dept_dict = {"AFRICAM": "AFRICAN AMERICAN STUDIES",
             "AMERSTD":"AMERICAN STUDIES",
             "ANTHRO": "ANTHROPOLOGY",
             'ARCH': "ARCHITECTURE",
             'ART': "ART PRACTICE",
             'ARTHIST': "ART HISTORY",
             'ANTHRO': "ANTHROPOLOGY",
             'ASAMST': "ASIAN AMERICAN STUDIES",
             'UGBA': "BUSINESS ADMINISTRATION (UGBA)",
             'CHICANO': "CHICANO STUDIES",
             'CYPLAN': "CITY AND REGIONAL PLANNING",
             'COLWRIT': "COLLEGE WRITING",
             'COMPLIT': "COMPARATIVE LITERATURE",
             'DEMOG': "DEMOGRAPHY",
             'TDPS': "",
             'DUTCH': "DUTCH STUDIES",
             'EPS': "EARTH AND PLANETARY SCIENCE",
             'EDUC': "EDUCATION",
             'ENGIN': "ENGINEERING",
             'ENGLISH': "ENGLISH",
             'ENVECON': "ENVIRONMENTAL ECONOMICS",
             'ESPM': "ENVIRONMENTAL SCIENCE, POLIC...",
             'ETHSTD': "ETHNIC STUDIES",
             'FILM': "FILM STUDIES",
             'FRENCH': "FRENCH",
             'GEOG': "GEOGRAPHY",
             'GWS': "GENDER & WOMEN'S STUDIES (fo...",
             'LGBT': "LGBT",
             'GPP': "GLOBAL PROVERTY AND PRACTICE",
             'HISTORY': "HISTORY",
             'HUMAN BIODYNAMICS': "HUMAN BIODYNAMICS",  # MAY NEED ADJUSTMENT
             'INFO': "INFORMATION (formerly INFORM...",
             'INTEGBI': "INTEGRATIVE BIOLOGY",
             'INTERDEPARTMENTAL STUDIES': "INTERDEPARTMENTAL STUDIES",  # MAY NEED ADJUSTMENT
             'UNDERGRADUATE INTERDISCIPLINATRY STUDIES': "INTERDISCIPLINARY STUDIES"
             }  # may not be needed.

    #  for every course in course list, get the department, cross check with the dictionary of departments

    c_departments = courses["Department_FULL"]
    # testing that we're getting full names of the departments
    print(c_departments[0])
    print(departments)

    # loop through each row, check that the instructors are on the senate list.
    print(len(courses))
    for c in range(0, len(c_departments)):
        d_i = c_departments[c]
        print(d_i)

        s_d = departments[d_i]
        print(s_d)


main()
